  CREATE OR REPLACE FORCE EDITIONABLE VIEW "PUBDB"."OCQ_DESPESAS_ORACADO_V" ("CONTAGEM", "KCO", "TIPO", "STATUS", "CIA", "DOC", "LOTE", "DATA_PEDIDO", "DATA_PROMET", "DATA_RECEB", "DATA_CONT", "MES", "ANO", "POST", "VALOR_RECEBER", "VALOR_RECEBIDO", "CONTA", "OBJ", "SUB", "LEGENDA", "COD", "MOTIVO", "RAZAO", "PEDIDO", "TIPO_PEDIDO", "LINHA", "CENTRO", "AN8", "FILIAL", "JUSTIFICATIVA", "SOLICITANTE", "COMPRADOR", "REFERENCIA", "O_ANO", "O_COD_CENTRO_CUST", "O_CENTRO_CUST", "O_CONTA_CONT", "O_LIVRO", "O_MES", "VALOR", "O_CONTA", "O_GMMCU", "O_GMOBJ", "O_GMSUB") AS 
SELECT
ROW_NUMBER() over(PARTITION BY O.conta,O.COD_CENTRO_CUST,O.ANO,O.MES ORDER BY O.conta,O.COD_CENTRO_CUST,O.ANO,O.MES ASC) AS CONTAGEM,
R.KCO,
R.TIPO,
R.STATUS,
R.CIA,
R.DOC,
R.LOTE,
R.DATA_PEDIDO,
R.DATA_PROMET,
R.DATA_RECEB,
R.DATA_CONT,
R.MES,
R.ANO,
R.POST,
R.VALOR_RECEBER,
R.VALOR_RECEBIDO,
R.CONTA,
R.OBJ,
R.SUB,
R.LEGENDA,
R.COD,
R.MOTIVO,
R.RAZAO,
R.PEDIDO,
R.TIPO_PEDIDO,
R.LINHA,
R.CENTRO,
R.AN8,
R.FILIAL,
R.JUSTIFICATIVA,
R.SOLICITANTE,
R.COMPRADOR,
R.REFERENCIA,
O.ANO AS O_ANO,
O.COD_CENTRO_CUST AS O_COD_CENTRO_CUST,
O.CENTRO_CUST AS O_CENTRO_CUST,
O.CONTA_CONT AS O_CONTA_CONT,
O.LIVRO AS O_LIVRO,
O.MES AS O_MES,
CASE WHEN ROW_NUMBER() over(PARTITION BY O.conta,O.COD_CENTRO_CUST,O.ANO,O.MES ORDER BY O.conta,O.COD_CENTRO_CUST,O.ANO,O.MES ASC) = 1 
    then O.VALOR else NULL 
end VALOR,
trim(O.CONTA) AS O_CONTA,
trim(O.GMMCU) AS O_GMMCU,
O.GMOBJ AS O_GMOBJ,
O.GMSUB AS O_GMSUB
from PUBDB.DESPESAS_ANALYTICS R
LEFT JOIN PUBDB.JDE_ORCAMENTO O ON O.ANO = R.ANO AND O.MES = R.MES AND trim(O.CONTA) = trim(R.CONTA) AND O.COD_CENTRO_CUST = R.CENTRO
where R.ANO in ('22','23','24');